{
  "_comment": "Enterprise-Grade Detection Configuration",
  "_version": "2.0",
  
  "detection_engine": {
    "enabled": true,
    "mode": "enterprise",
    "comment": "Options: basic, enterprise, maximum"
  },
  
  "machine_learning": {
    "enabled": true,
    "model_path": "ml_models/anomaly_detector.pkl",
    "auto_train": true,
    "training_interval_hours": 24,
    "min_samples_for_training": 100,
    "contamination_rate": 0.1,
    "comment": "Isolation Forest parameters"
  },
  
  "yara_signatures": {
    "enabled": true,
    "rules_path": "yara_rules",
    "auto_update": false,
    "scan_timeout_seconds": 10,
    "scan_memory": true,
    "scan_files": true
  },
  
  "behavioral_analysis": {
    "enabled": true,
    "thresholds": {
      "files_modified_per_min": 50,
      "files_deleted_per_min": 20,
      "files_renamed_per_min": 30,
      "high_entropy_threshold": 7.5,
      "suspicious_entropy_threshold": 7.0,
      "network_connections_threshold": 10
    },
    "track_process_trees": true,
    "track_registry_changes": true
  },
  
  "threat_intelligence": {
    "enabled": true,
    "cache_ttl_seconds": 3600,
    "sources": {
      "virustotal": {
        "enabled": false,
        "api_key_env": "VIRUSTOTAL_API_KEY",
        "rate_limit_per_minute": 4,
        "check_file_hashes": true
      },
      "abuseipdb": {
        "enabled": false,
        "api_key_env": "ABUSEIPDB_API_KEY",
        "check_ip_addresses": true,
        "confidence_threshold": 25
      },
      "alienvault_otx": {
        "enabled": false,
        "api_key_env": "OTX_API_KEY",
        "check_indicators": true
      }
    }
  },
  
  "mitre_attack": {
    "enabled": true,
    "map_tactics": true,
    "map_techniques": true,
    "include_in_alerts": true
  },
  
  "siem": {
    "enabled": false,
    "format": "cef",
    "comment": "Options: cef, leef, json, syslog",
    "batch_size": 100,
    "batch_timeout_seconds": 5,
    "include_full_context": true,
    "endpoints": [
      {
        "type": "file",
        "name": "Local SIEM Log",
        "enabled": true,
        "path": "logs/siem_events.log",
        "max_size_mb": 100,
        "rotate": true
      },
      {
        "type": "http",
        "name": "Splunk HEC",
        "enabled": false,
        "url": "https://splunk.company.com:8088/services/collector/raw",
        "headers": {
          "Authorization": "Splunk YOUR_HEC_TOKEN",
          "Content-Type": "application/json"
        },
        "verify_ssl": true,
        "timeout_seconds": 10
      },
      {
        "type": "syslog",
        "name": "QRadar",
        "enabled": false,
        "host": "qradar.company.com",
        "port": 514,
        "protocol": "tcp",
        "comment": "Options: udp, tcp"
      },
      {
        "type": "syslog",
        "name": "ArcSight",
        "enabled": false,
        "host": "arcsight.company.com",
        "port": 514,
        "protocol": "udp"
      }
    ]
  },
  
  "alerting": {
    "email": {
      "enabled": false,
      "smtp_server": "smtp.gmail.com",
      "smtp_port": 587,
      "smtp_use_tls": true,
      "smtp_user": "your-email@gmail.com",
      "smtp_password_env": "EMAIL_PASSWORD",
      "from_address": "antiransomware@yourcompany.com",
      "to_addresses": [
        "security@yourcompany.com",
        "soc@yourcompany.com"
      ],
      "severity_filter": ["HIGH", "CRITICAL"],
      "include_mitre_mapping": true
    },
    "slack": {
      "enabled": false,
      "webhook_url_env": "SLACK_WEBHOOK_URL",
      "channel": "#security-alerts",
      "username": "Anti-Ransomware Bot",
      "severity_filter": ["MEDIUM", "HIGH", "CRITICAL"],
      "mention_on_critical": true,
      "mention_users": ["@security-team"]
    },
    "teams": {
      "enabled": false,
      "webhook_url_env": "TEAMS_WEBHOOK_URL",
      "severity_filter": ["HIGH", "CRITICAL"],
      "adaptive_cards": true
    },
    "pagerduty": {
      "enabled": false,
      "integration_key_env": "PAGERDUTY_KEY",
      "severity_filter": ["CRITICAL"],
      "auto_escalate": true
    }
  },
  
  "compliance": {
    "enabled": true,
    "frameworks": ["SOC2", "HIPAA", "PCI-DSS", "NIST"],
    "database_path": "compliance.db",
    "report_generation": {
      "auto_generate": true,
      "schedule": "monthly",
      "output_path": "reports/compliance",
      "formats": ["json", "pdf", "csv"]
    },
    "evidence_collection": {
      "enabled": true,
      "retention_days": 365,
      "encrypt_evidence": true
    }
  },
  
  "forensics": {
    "enabled": true,
    "capture_process_dumps": false,
    "capture_memory_samples": false,
    "capture_network_pcaps": false,
    "evidence_path": "forensics/evidence",
    "max_evidence_size_mb": 1000,
    "auto_cleanup_days": 90
  },
  
  "incident_response": {
    "enabled": true,
    "auto_contain": {
      "enabled": true,
      "on_critical": true,
      "on_high": false,
      "actions": ["isolate_process", "block_network", "snapshot_system"]
    },
    "playbooks": {
      "ransomware_detected": {
        "enabled": true,
        "steps": [
          "isolate_system",
          "terminate_malicious_processes",
          "block_c2_communication",
          "create_forensic_snapshot",
          "alert_soc_team",
          "initiate_recovery"
        ]
      }
    }
  },
  
  "performance": {
    "max_cpu_percent": 15,
    "max_memory_mb": 512,
    "scan_throttle_ms": 100,
    "enable_profiling": false,
    "metrics_collection": true,
    "metrics_interval_seconds": 60
  },
  
  "logging": {
    "level": "INFO",
    "comment": "Options: DEBUG, INFO, WARNING, ERROR, CRITICAL",
    "file_path": "logs/enterprise_detection.log",
    "max_size_mb": 50,
    "backup_count": 10,
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    "console_output": true
  },
  
  "advanced": {
    "enable_sandbox_analysis": false,
    "sandbox_timeout_seconds": 300,
    "enable_network_analysis": true,
    "enable_registry_monitoring": true,
    "enable_kernel_callbacks": false,
    "enable_etw_tracing": false,
    "comment": "ETW = Event Tracing for Windows (requires admin)"
  }
}
