<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Anti-Ransomware Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            color: #eee;
        }
        .header {
            background: #16213e;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .header h1 {
            color: #0f3460;
            font-size: 24px;
        }
        .container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #16213e;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .stat-card h3 {
            color: #e94560;
            font-size: 14px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
        }
        .section {
            background: #16213e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .section h2 {
            color: #e94560;
            margin-bottom: 15px;
            border-bottom: 2px solid #0f3460;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #0f3460;
        }
        th {
            background: #0f3460;
            color: #e94560;
            font-weight: 600;
        }
        tr:hover {
            background: #1a1a2e;
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-critical { background: #e94560; color: white; }
        .status-high { background: #ff6b6b; color: white; }
        .status-medium { background: #ffa500; color: white; }
        .status-low { background: #4ecdc4; color: white; }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-primary { background: #0f3460; color: white; }
        .btn-danger { background: #e94560; color: white; }
        .btn:hover { opacity: 0.8; }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            background: #e94560;
            color: white;
            display: none;
        }
        .timestamp {
            color: #888;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ°Ô∏è Real Anti-Ransomware Protection Dashboard</h1>
    </div>

    <div class="container">
        <div id="alert" class="alert"></div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>Threats Detected</h3>
                <div class="value" id="threats-count">0</div>
            </div>
            <div class="stat-card">
                <h3>Files Quarantined</h3>
                <div class="value" id="quarantine-count">0</div>
            </div>
            <div class="stat-card">
                <h3>Active Processes</h3>
                <div class="value" id="processes-count">0</div>
            </div>
            <div class="stat-card">
                <h3>System Status</h3>
                <div class="value" id="system-status">Protected</div>
            </div>
        </div>

        <div class="section">
            <h2>Recent Threats</h2>
            <table id="threats-table">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Severity</th>
                        <th>Type</th>
                        <th>Process</th>
                        <th>File</th>
                    </tr>
                </thead>
                <tbody id="threats-body">
                    <tr><td colspan="5" style="text-align: center; color: #888;">No threats detected</td></tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>Quarantined Files</h2>
            <table id="quarantine-table">
                <thead>
                    <tr>
                        <th>File</th>
                        <th>Quarantined</th>
                        <th>Threat Score</th>
                        <th>Process</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="quarantine-body">
                    <tr><td colspan="5" style="text-align: center; color: #888;">No quarantined files</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        const socket = io();

        function updateMetrics() {
            fetch('/api/metrics')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('threats-count').textContent = data.threats_detected || 0;
                    document.getElementById('quarantine-count').textContent = data.files_quarantined || 0;
                    document.getElementById('processes-count').textContent = data.processes_monitored || 0;
                });
        }

        function updateThreats() {
            fetch('/api/threats')
                .then(r => r.json())
                .then(data => {
                    const tbody = document.getElementById('threats-body');
                    if (data.threats && data.threats.length > 0) {
                        tbody.innerHTML = data.threats.map(t => `
                            <tr>
                                <td class="timestamp">${new Date(t.timestamp).toLocaleString()}</td>
                                <td><span class="status-badge status-${t.severity}">${t.severity.toUpperCase()}</span></td>
                                <td>${t.type}</td>
                                <td>${t.process}</td>
                                <td>${t.file || 'N/A'}</td>
                            </tr>
                        `).join('');
                    }
                });
        }

        function updateQuarantine() {
            fetch('/api/quarantine')
                .then(r => r.json())
                .then(data => {
                    const tbody = document.getElementById('quarantine-body');
                    if (data.files && data.files.length > 0) {
                        tbody.innerHTML = data.files.map(f => `
                            <tr>
                                <td>${f.original_path}</td>
                                <td class="timestamp">${new Date(f.quarantine_date).toLocaleString()}</td>
                                <td>${f.threat_score}</td>
                                <td>${f.process_name || 'Unknown'}</td>
                                <td>
                                    <button class="btn btn-primary" onclick="restore(${f.id})">Restore</button>
                                    <button class="btn btn-danger" onclick="deleteFile(${f.id})">Delete</button>
                                </td>
                            </tr>
                        `).join('');
                    }
                });
        }

        function restore(id) {
            if (confirm('Restore this file?')) {
                fetch(`/api/quarantine/restore/${id}`, { method: 'POST' })
                    .then(r => r.json())
                    .then(data => {
                        alert(data.message || 'File restored');
                        updateQuarantine();
                        updateMetrics();
                    });
            }
        }

        function deleteFile(id) {
            if (confirm('Permanently delete this file?')) {
                fetch(`/api/quarantine/delete/${id}`, { method: 'DELETE' })
                    .then(r => r.json())
                    .then(data => {
                        alert(data.message || 'File deleted');
                        updateQuarantine();
                        updateMetrics();
                    });
            }
        }

        socket.on('threat_alert', (data) => {
            const alert = document.getElementById('alert');
            alert.textContent = `‚ö†Ô∏è Threat Detected: ${data.message}`;
            alert.style.display = 'block';
            setTimeout(() => alert.style.display = 'none', 5000);
            updateMetrics();
            updateThreats();
        });

        // Initial load
        updateMetrics();
        updateThreats();
        updateQuarantine();

        // Auto-refresh every 5 seconds
        setInterval(() => {
            updateMetrics();
            updateThreats();
            updateQuarantine();
        }, 5000);
    </script>
</body>
</html>
