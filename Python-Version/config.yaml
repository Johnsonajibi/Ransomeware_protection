# Real Anti-Ransomware Configuration
# Production configuration file

# Detection Engine Settings
detection:
  # Behavioral analysis thresholds
  rapid_write_threshold: 50  # Files modified in time window
  time_window_seconds: 30    # Time window for rapid detection
  score_threshold_high: 61   # High risk threshold
  score_threshold_critical: 91  # Critical risk threshold
  
  # Scoring weights
  extension_change_score: 40
  rapid_modification_score: 30
  delete_on_close_score: 25
  suspicious_origin_score: 15
  network_activity_score: 20
  registry_persistence_score: 10
  high_entropy_score: 35
  
  # Entropy analysis
  entropy_threshold: 7.5  # Files with entropy > this are flagged
  entropy_sample_size: 65536  # Bytes to sample for entropy calculation

# File Monitor Settings
file_monitor:
  # Paths to monitor (will use defaults if not specified)
  watch_paths:
    - "C:\\Users\\$env:USERNAME\\Documents"
    - "C:\\Users\\$env:USERNAME\\Desktop"
    - "C:\\Users\\$env:USERNAME\\Pictures"
    - "C:\\Users\\$env:USERNAME\\Downloads"
  
  # Paths to exclude from monitoring
  exclude_paths:
    - "C:\\Windows"
    - "C:\\Program Files"
    - "C:\\Program Files (x86)"
    - "~\\AppData\\Local\\Temp"
  
  # Monitoring options
  recursive: true
  poll_interval: 2  # Seconds (for polling mode)
  max_events_per_process: 1000

# Process Monitor Settings
process_monitor:
  enable: true
  check_interval: 2  # Seconds
  track_process_tree: true
  suspicious_score_threshold: 30

# Quarantine Settings
quarantine:
  directory: "./data/quarantine"
  auto_quarantine_threshold: 80  # Auto-quarantine if score >= this
  max_quarantine_days: 30  # Auto-delete files older than this
  max_quarantine_size_mb: 5000  # Maximum quarantine directory size

# Backup & Recovery Settings
backup:
  enable_auto_backup: true
  backup_directory: "./data/backups"
  backup_interval_hours: 6
  max_backup_age_days: 7
  vss_snapshot_enable: true

# Logging Settings
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "C:\\ProgramData\\AntiRansomware\\logs\\antiransomware.log"
  max_size_mb: 100
  backup_count: 10
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  # Windows Event Log
  windows_event_log: true
  event_source: "RealAntiRansomware"

# Alerting Settings
alerts:
  enable: true
  
  # Alert channels
  channels:
    gui_popup: true
    email: false
    syslog: false
    webhook: false
  
  # Email settings (if enabled)
  email:
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    use_tls: true
    username: "alerts@example.com"
    password: ""  # Use environment variable ANTIRANSOMWARE_EMAIL_PASSWORD
    recipients:
      - "admin@example.com"
  
  # Syslog settings (if enabled)
  syslog:
    server: "siem.example.com"
    port: 514
    protocol: "UDP"  # UDP or TCP
  
  # Webhook settings (if enabled)
  webhook:
    url: "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"
    method: "POST"
    headers:
      Content-Type: "application/json"

# Web Dashboard Settings
dashboard:
  enable: true
  host: "127.0.0.1"
  port: 8080
  debug: false
  secret_key: "change-this-secret-key-in-production"
  
  # Authentication
  auth_enable: true
  username: "admin"
  password_hash: ""  # Use bcrypt hash
  
  # Update intervals
  metrics_update_interval: 5  # Seconds
  chart_data_points: 100

# Database Settings
database:
  path: "C:\\ProgramData\\AntiRansomware\\antiransomware.db"
  backup_enable: true
  backup_interval_hours: 24

# Driver Communication Settings
driver:
  device_name: "\\\\.\\AntiRansomwareFilter"
  status_check_interval: 10  # Seconds
  auto_restart_on_failure: true

# Performance Settings
performance:
  max_memory_mb: 500  # Maximum memory usage
  cleanup_interval_minutes: 60  # Clean old events from memory
  max_event_age_minutes: 60  # Events older than this are removed

# Service Settings
service:
  name: "RealAntiRansomware"
  display_name: "Real Anti-Ransomware Protection"
  description: "Enterprise-grade ransomware protection service"
  start_type: "auto"  # auto, manual, disabled

# Update Settings
updates:
  check_for_updates: true
  update_interval_hours: 24
  signature_update_url: "https://updates.example.com/signatures"
  auto_update_signatures: true

# Advanced Settings
advanced:
  enable_ml_detection: true  # Machine learning detection
  ml_model_path: "models/ransomware_classifier.pkl"
  ml_threshold: 0.85  # ML confidence threshold
  
  enable_tpm: true  # TPM 2.0 integration
  tpm_verify_boot: true  # Verify boot integrity
  tpm_seal_keys: true  # Seal encryption keys to TPM
  
  enable_network_monitoring: true
  enable_registry_monitoring: true
  enable_forensics_mode: true  # Detailed forensics with full memory dumps
  
  # Memory dump settings
  memory_dump_on_critical: true  # Auto-dump on critical threats
  memory_dump_type: "full"  # mini, full, or heap
